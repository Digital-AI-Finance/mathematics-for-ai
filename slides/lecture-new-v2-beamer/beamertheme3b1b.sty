%% beamertheme3b1b.sty — Custom 3Blue1Brown dark theme for Beamer
%% Requires colors defined in preamble.tex (BGDark, TextPrimary, etc.)

\ProvidesPackage{beamertheme3b1b}
\RequirePackage{tikz}

%% Background — radial vignette (dark edges, lighter center)
\setbeamercolor{background canvas}{bg=}
\setbeamertemplate{background}{%
  \begin{tikzpicture}[remember picture, overlay]
    \shade[inner color=BGDark, outer color=BGDarker]
      (current page.south west) rectangle (current page.north east);
  \end{tikzpicture}%
}

%% Text colors
\setbeamercolor{normal text}{fg=TextPrimary}
\setbeamercolor{structure}{fg=PillarBlue}
\setbeamercolor{alerted text}{fg=AccentYellow}
\setbeamercolor{example text}{fg=PillarGreen}

%% Frame title — with accent underline
\setbeamercolor{frametitle}{fg=TextPrimary, bg=}
\setbeamerfont{frametitle}{size=\LARGE, series=\bfseries}
\setbeamertemplate{frametitle}{%
  \vspace*{6pt}%
  \usebeamerfont{frametitle}\usebeamercolor[fg]{frametitle}%
  \insertframetitle\par%
  \vspace*{3pt}%
  {\color{PillarBlue!50}\rule{0.35\textwidth}{1.5pt}}%
  \vspace*{2pt}%
}

%% Title page
\setbeamercolor{title}{fg=TextPrimary}
\setbeamercolor{subtitle}{fg=PillarTeal}
\setbeamercolor{author}{fg=TextSecondary}
\setbeamercolor{date}{fg=TextSecondary}
\setbeamerfont{title}{size=\Huge, series=\bfseries}
\setbeamerfont{subtitle}{size=\large}

%% Item colors
\setbeamercolor{itemize item}{fg=PillarBlue}
\setbeamercolor{itemize subitem}{fg=PillarTeal}
\setbeamercolor{enumerate item}{fg=PillarBlue}
\setbeamertemplate{itemize item}{\small\raise1pt\hbox{\color{PillarBlue}$\bullet$}}

%% No navigation symbols
\setbeamertemplate{navigation symbols}{}

%% Footline: thin separator + short title left + page number right
\setbeamertemplate{footline}{%
  \begin{tikzpicture}[remember picture, overlay]
    \draw[TextSecondary!15, line width=0.5pt]
      ([yshift=12pt]current page.south west) --
      ([yshift=12pt]current page.south east);
  \end{tikzpicture}%
  \hspace*{10pt}%
  {\tiny\color{TextSecondary!50}\textls[50]{\MakeUppercase{\insertshorttitle}}}%
  \hfill%
  {\tiny\color{TextSecondary}%
    \insertframenumber\,/\,\inserttotalframenumber}%
  \hspace*{10pt}\vspace*{4pt}%
}

%% Block environment colors
\setbeamercolor{block title}{fg=PillarBlue, bg=BGCard}
\setbeamercolor{block body}{fg=TextPrimary, bg=BGCard}
